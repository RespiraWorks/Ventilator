# Wiring

The following page describes the custom wiring components required in the electrical assembly. Manufacturing
these components will require soldering and crimping.

## Parts

**Note: If you are a member of the RespiraWorks team, review the [part purchasing guidelines][ppg]
BEFORE purchasing any parts.**

[ppg]: ../purchasing_guidelines.md

| Item  | Quantity | Manufacturer  | Part #                | Price (USD)  | Sources[*][ppg]      | Notes |
| ----- |---------:| ------------- | --------------------- | ------------:|:--------------------:| ----- |
|**A1** | 20       | JST           | SXH-001T-P0.6         |         0.10 | [K][a1key]           | XH crimps, for sensor & actuator connections |
|**A2** | 1        | JST           | XHP-2                 |         0.10 | [K][a2key]           | XH 2-pin housings, for solenoid |
|**A3** | 1        | JST           | XHP-3                 |         0.10 | [K][a3key]           | XH 3-pin housings, for oxygen sensor |
|**A4** | 1        | JST           | XHP-6                 |         0.12 | [K][a4key]           | XH 6-pin housings, for blower control |
|**A5** | 7        | JST           | SVH-21T-P1.1          |         0.11 | [K][a5key] [R][a5rs] | VH crimps, for main power, for blower power |
|**A6** | 2        | TE            | 1-1123722-2           |         0.18 | [K][a6key] [R][a6rs] | VH housing 2 pin, for blower power |
|**A7** | 1        | JST           | VHR-3N                |         0.14 | [K][a7key]           | VH housing 3 pin, for main power |
|**A9** | 1        | Kycon         | KPJX-PM-4S            |         2.89 | [K][a9key]           | 4 pin DIN female, main power connector |
|**A10**| 8        |TE Connectivity| 102107-3              |         0.47 | [K][a10key]          | 2.54mm male pin, for stepper interface |
|**A11**| 2        |TE Connectivity| 87499-7               |         0.73 | [K][a11key]          | 2.54mm 4-pin housing, for stepper interface |
|**A12**|        - | Remington     | 16UL1007STRKIT        |  29.70 / 45m | [Z][a12amzn]         | 16 AWG wire, for power cables |
|**A13**|        - | Remington     | 22UL1015STRKIT10COLOR |  37.75 / 75m | [Z][a13amzn]         | 22 AWG wire, for signal/control cables |
|**A14**|        - | Remington     | 26UL1007STRKIT10COLOR |  31.60 / 75m | [Z][a14amzn]         | 26 AWG wire, for signal/control cables |
|**A15**| (1)      | WGCD          | 4330589508            |         8.99 | [Z][a15amzn]         | XH connector kit for 2/3/4/5 pins, **alternative for A1-3** |
|**A16**| (1)      | CQRobot       | CQRJST254-BGB         |         9.99 | [Z][a16amzn]         | XH connector kit for 6/7/8 pins, **alternative for A1 and A4** |
|**A17**| (1)      | Chenbo        | WJ-Z01                |        11.98 | [Z][a17amzn]         | 2.54mm connector kit, **alternative for A10 and A11** |
|**A18**| 2        | Molex         | 22013037              |      0.20/ea | [K][a18key]          | KK-series 3-pin sockets connector housing (oxygen sensor) |
|**A19**| 4        | Molex         | 08550102              |      0.21/ea | [K][a19key]          | crimp sockets for the above |

[a1key]:   https://www.digikey.com/short/z44f8d
[a2key]:   https://www.digikey.com/short/z44f8f
[a3key]:   https://www.digikey.com/short/z44fb9
[a4key]:   https://www.digikey.com/short/z44ff8
[a5key]:   https://www.digikey.com/short/z44fjr
[a5rs]:    https://export.rsdelivers.com/product/jst/svh-41t-p11/jst-nv-vh-female-crimp-terminal-contact-16awg-svh/7620692
[a6key]:   https://www.digikey.com/short/z44fwj
[a6rs]:    https://export.rsdelivers.com/product/jst/vhr-2n/jst-vhr-female-connector-housing-396mm-pitch-2/8201172
[a7key]:   https://www.digikey.com/short/z44fwp
[a9key]:   https://www.digikey.com/en/products/detail/kycon-inc/KPJX-PM-4S/9990081
[a10key]:  https://www.digikey.com/en/products/detail/te-connectivity-amp-connectors/102107-3/298993
[a11key]:  https://www.digikey.com/en/products/detail/te-connectivity-amp-connectors/87499-7/29911
[a12amzn]: https://www.amazon.com/gp/product/B00N51OJJ4
[a13amzn]: https://www.amazon.com/gp/product/B073SDGNKW
[a14amzn]: https://www.amazon.com/gp/product/B011JC76OA
[a15amzn]: https://www.amazon.com/gp/product/B06ZZ45G7G
[a16amzn]: https://www.amazon.com/gp/product/B079MJ1RYN
[a17amzn]: https://www.amazon.com/CHENBO-Connector-Housing-Assortment-Terminal/dp/B077X8XV2J
[a18key]:  https://www.digikey.com/en/products/detail/molex/0022013037/26433
[a19key]:  https://www.digikey.com/en/products/detail/molex/0008550102/172056

**#TODO:** Add shrink tubing

## Tools

| Item | Manufacturer | Part number         | Price($) | Sources[*][ppg] | Notes |
| ---- | ------------ | ------------------- | --------:|-----------------| ----- |
| B1   | Preciva      | PR-3254 (PR102001)  |    39.99 | [Z][b1amzn]     | Crimping tool for HX and HV connectors + connector kit |
| B2   | NovelLife    | TS100               |    74.99 | [Z][b2amzn]     | 65W Soldering iron kit |
| B3   | Chandler     | HG603D              |    24.92 | [Z][b3amzn]     | Heat gun, for shrink tubing |
| B4   | Kester       | KE1107-ND           |    58.98 | [K][b4key]      | Solder |

[b1amzn]: https://www.amazon.com/gp/product/B07R1H3Z8X
[b2amzn]: https://www.amazon.com/NovelLife-Mini-TS100-Soldering-Digital/dp/B07D35B75T
[b3amzn]: https://www.amazon.com/Chandler-Tool-Embossing-Heat-Gun/dp/B07GC5N3QC
[b4key]:  https://www.digikey.com/en/products/detail/kester-solder/24-6040-0010/265622

**Crimper Tips:**

* Position 1 on the crimper will crimp JST XH contacts and Molex KK contacts
* Position 2 on the crimper will crimp VH contacts.  However, with certain gauges of wire, this crimper may bend the contact into a shrimp-like shape.  If this happens, bend the contact back straight (it should be pretty obvious as it blocks insertion)
* It comes with a lot of XH contacts, but not any VH contacts.

## Assembly

As much as possible we should try to keep the cables one-to-one
(for example the wiring of the PCB to blower driver cables are all pin 1 to pin 1,
pin 2 to pin 2, etc. with the same connector style on both ends.

### Main power

**#TODO: how to? what is the DIN pinout? @inceptionev**

Using:
* DIN female `A9`
* 22AWG wire (length?) `A12`
* 3x VH crimps `A5`
* VH 3-pin housing `A7`

### Blower wiring

The power and signal cables that come included with the blower will be too short to reach the PCB, so new ones
must be manufactured using crimping tool `B1`:

* power cable:
  - 16AWG 60cm `[A12]`
  - 4x VH crimps `[A5]`
  - 2x VH 2-pin housings `[A6]`
* control cable:
  - 26AWG 60cm `[A14]`
  - 12x XH crimps `[A1]`
  - 2x XH 6-pin housings `[A4]`

Please follow the old cables included with blower as examples.

**#TODO:** Some sort of shrink tubing should also be used

**#TODO:** pictures

### Stepper wiring

To power and control the pinch valves, they will need to be wired to the stepper driver boards. Two pigtails
can be produced for this purpose:

Recipe for one pigtail:
* 22AWG 15cm `[A13]`
* 4x male 2.54mm pins `[A10]`
* 2.54mm 4-pin housing `[A11]`

On the other end, each wire should be stripped about 5mm and solder applied to bind the threads.

It is advisable to label these pigtails to identify which stepper driver they shall be wired up to.
The same can be done for the stepper motors belonging to each pinch valve assembly.

| Pigtails | Stepper wires  |
|:--------:|:--------:|
| ![](images/pigtails.jpg) | ![](images/stepper_labels.jpg) |

**#TODO: power wires in case of 2 boards**

### Proportional solenoid valve

To connect the solenoid to the PCB, you will need to crimp a 2-pin XH connector to the wires:
- 2x XH crimps `[A1]`
- XH 6-pin housings `[A2]`

**#TODO: polarity does not matter? @inceptionev**

**#TODO:** pictures

### Oxygen sensor

| Cable Image | Cable Drawing (PDF)  |
|:--------:|:--------:|
| ![Oxygen Sensor Cable](images/oxygen_sensor_cable.jpg) | [![Oxygen Sensor Cable Drawing](images/oxygen_sensor_cable_drawing_image.jpg)](drawings/20210209_oxygen_sensor_cable_drawing.pdf) |

- Measure out two 40cm lengths of 26AWG wire, in green and white `[A14]`
- Strip the ends of the wires
- Using the crimper `[B1]` in position 1, crimp 4x contacts `[A19]` onto the ends of the wires.
- A proper crimp should crimp the insulation in the lower half and the wire in the upper half of the crimp portion of the contact.
- Insert the wires into the connector housings `[A18]`, according to the drawing, until they click.  Pin 1 is marked by a tiny '1' molded into the connector housing.
- Do a gentle pull test to make sure that the contacts are properly crimped and seated.

**#TODO:** pictures

## Pricing totals

**#TODO:** do this when finalized
